---
title: Deadlock
description: 181124 Today I learned Deadlock
categories:
 - TIL
tags: [교착상태, deadlock]
---

`TIL 카테고리의 글은 그날 배운 것을 정리하는 목적으로 포스팅합니다. 내용이 잘못되었다면 댓글로 피드백 부탁드립니다.`

# Deadlock (교착상태)

> 요청한 자원을 다른 프로세스가 점유하고 있고 점유하고있는 프로세스도 다른 자원에 대해 대기 상태에 있기 때문에 두 프로세스가 대기 상태에서 벗어날 수 없는 상황

### 시스템 모델

프로세스가 사용하는 자원(resource)에는 어떤 것들이 있을까?

- request
- use
- release 

정상적인 프로세스는 다음 순서로만 자원을 사용할 수 있음.

#### request

프로세스는 자원을 요청하고, 즉시 허용되지 않는 경우 자원을 얻을 때 까지 대기상태에 놓임

#### use

프로세스는 자원에 대해 작업을 수행함.

#### release

프로세스가 자원을 다 사용했다면 방출함.  



이러한 경쟁 구도에 놓인 프로세스들은 자원을 요청하는 시점에 해당 자원이 다른 프로세스에 의해 점유되어있으면 대기 상태에 놓이고 각 프로세스와 자원들이 서로 꼬리를 물며 자원을 대기하는 경우를 `교착상태`에 놓여져있다고 함. 



### 교착상태 발생조건

1. 상호배제 `mutual exclusion` 
   - 프로그램들이 공유 자원을 동시에 쓸 수 없는 상황
2. 점유 상태로 대기
   - 공유 자원을 점유한 상태에서 다른 자원을 기다리는 것
3. 선점 불가
   - 자원을 어떤 프로세스가 점유 중일 때 다른 프로세스가 그 자원을 뺏을 수 없는 것
4. 순환성 대기
   - 대기가 꼬리에 꼬리를 문 상황

교착상태가 발생하려면 위 4가지 조건이 반드시 성립되어야함.

###  교착상태 처리방법

1. 교착상태를 예방하거나 회피.
2. 시스템이  교착상태가 되도록 허용한 다음 이를 회복시키는 방법.
3. 시스템의 교착상태를 무시하고 발생하지 않는 것 처럼 꾸미는 방법(실제 OS에서 사용)

####  교착상태 예방

- 상호배제 : 읽기 전용 같은 여러 프로세스가 동시에 접근할 수 있는 파일에는 상호배제가 필요하지 않기 때문에 상호배제가 깨어지게 되어 교착상태를 예방할 수 있음. but 공유 불가능한 데이터에서는 교착 상태를 예방하지 못하는 경우가 발생할 수 있음.
- 점유하며 대기 :  프로세스가 어떤 자원을 점유하고 있을 때다른 자원을 요청하지 못하도록 보장해야함. 자기 자신이 아무런 자원을 점유하고 있지 않을 때에만 다른 자원을 요청할 수 있어야함. 
  - 프로세스가 실행되기 전에 자신이 필요한 모든 자원을 요청하여 할당 받는 것
  - 많은 자원들이 할당 된 후 오랫동안 사용되지 않아 자원의 이용률이 낮아짐.
  - 필요한 자원 중 최소 하나가 계속 다른 프로세스에게 할당되어 있으면 이 프로세스는 무한정 대기해야하는 가능성이 생김.(기아상태)



